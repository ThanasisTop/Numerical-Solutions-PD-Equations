-- FreeFem++ v4.400003 (jeu. 12 dΓ©c. 2019 13:58:15 - git v4.4-3-9-gc37e08e1)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : real [int] errorH1(7);
    2 : real [int] errorH0(7);
    3 : real [int] errorP(7);
    4 : real [int] h(7);
    5 : real epsilon=1.0e-6;
    6 :
    7 : func u1=-sin(x*y)*x;
    8 : func u2=sin(x*y)*y;
    9 : func p=cos(x*y)-0.9460830703671845;
   10 :
   11 : func sol1x=-(cos(x*y)*x*y)-sin(x*y);
   12 : func sol2y=(cos(x*y)*x*y)+sin(x*y);
   13 :
   14 : func fx=-sin(x*y)*x*(x^2+y^2)+2.0*cos(x*y)*y-sin(x*y)*y;
   15 : func fy=sin(x*y)*y*(x^2+y^2)-2.0*cos(x*y)*x-sin(x*y)*x;
   16 :
   17 :
   18 : int n=1;
   19 :
   20 : for(int i=0; i<7; i++){
   21 :
   22 :
   23 : mesh Th = square(n,n);
   24 : plot(Th,wait=true);
   25 :
   26 : fespace Vh(Th, P1b);
   27 : Vh uh1,uh2;
   28 : Vh w1, w2;
   29 :
   30 : fespace Xh(Th, P1);
   31 : Xh ph, qh;
   32 :
   33 :
   34 : problem Stokes(uh1,uh2,ph,w1,w2,qh, solver=Crout)
   35 : =int2d(Th)(
   36 :  dx(uh1)*dx(w1)
   37 : +dy(uh1)*dy(w1)
   38 : +dx(uh2)*dx(w2)
   39 : +dy(uh2)*dy(w2))
   40 : -int2d(Th)(ph*(dx(w1)+dy(w2)))
   41 : -int2d(Th)(qh*(dx(uh1)+dy(uh2)))
   42 : +int2d(Th)(epsilon*ph*qh)
   43 :
   44 : +int2d(Th)(
   45 : -fx*w1-fy*w2
   46 : )
   47 :
   48 : +on(1,4, uh1=0, uh2=0)
   49 : +on(2, uh1=-sin(y), uh2=y*sin(y))
   50 : +on(3, uh1=-x*sin(x), uh2=sin(x));
   51 :
   52 : Stokes;
   53 :
   54 :
   55 : plot([uh1,uh2],ph,wait=true);
   56 :
   57 :
   58 : errorH0[i]=sqrt(int2d(Th)((u1-uh1)^2+(u2-uh2)^2));
   59 : errorH1[i]=sqrt(int2d(Th)((u1-uh1)*(u1-uh1)+(u2-uh2)*(u2-uh2))+int2d(Th)((dx(uh1)-sol1x)*(dx(uh1)-sol1x)+(dy(uh2)-sol2y)*(dy(uh2)-sol2y)));
   60 : errorP[i]=sqrt(int2d(Th)((ph-p)*(ph-p)));
   61 :
   62 :
   63 : n=2*n;
   64 : }
   65 :
   66 :
   67 : for(int i=0; i<6; i++){
   68 : cout<<"error for u with H0-norm = "<<errorH0[i]<<endl;
   69 : }
   70 : cout<<"-------------------------------------------------
  ... : "<<endl;
   71 : for(int i=0; i<6; i++){
   72 : cout<<"error for u with H1-norm = "<<errorH1[i]<<endl;
   73 : }
   74 : cout<<"-------------------------------------------------
  ... : "<<endl;
   75 : for(int i=0; i<6; i++){
   76 : cout<<"error for p with H0-norm = "<<errorP[i]<<endl;
   77 : }
   78 : cout<<"-------------------------------------------------
  ... : "<<endl;
   79 : for(int i=1; i<6; i++){
   80 :
   81 : cout<<"error order for u with H0-norm = "<<log(errorH0[i]/errorH0[i+1])/log(2.)<<endl;
   82 : cout<<"error order for u with H1-norm = "<<log(errorH1[i]/errorH1[i+1])/log(2.)<<endl;
   83 : cout<<"error order for p with H0-norm = "<<log(errorP[i]/errorP[i+1])/log(2.)<<endl;
   84 : cout<<"-------------------------------------------------
  ... : "<<endl;
   85 : }
   86 :
   87 :  sizestack + 1024 =4348  ( 3324 )
 
  -- Square mesh : nb vertices  =4 ,  nb triangles = 2 ,  nb boundary edges 4
  SkyLineMatrix: size pL/pU: 16 9freeglut (ffglut.exe): 5fgInitGL2: fghGenBuffers is NULL
 95 moy=5.9375
  -- Solve :
          min -0.841471  max 0.0408843
          min -0.0408842  max 0.841471
          min -10.3767  max 10.4231
  -- Square mesh : nb vertices  =9 ,  nb triangles = 8 ,  nb boundary edges 8
  SkyLineMatrix: size pL/pU: 43 394 394 moy=9.16279
  -- Solve :
          min -0.841471  max 0.00138386
          min -0.000683474  max 0.841471
          min -6.62834  max 6.68992
  -- Square mesh : nb vertices  =25 ,  nb triangles = 32 ,  nb boundary edges 16
  SkyLineMatrix: size pL/pU: 139 2073 2073 moy=14.9137
  -- Solve :
          min -0.841471  max 0.00173786
          min -0.00165875  max 0.841471
          min -3.58731  max 3.68913
  -- Square mesh : nb vertices  =81 ,  nb triangles = 128 ,  nb boundary edges 32
  SkyLineMatrix: size pL/pU: 499 13083 13083 moy=26.2184
  -- Solve :
          min -0.841471  max 0.000613885
          min -0.000604357  max 0.841471
          min -1.77681  max 1.88373
  -- Square mesh : nb vertices  =289 ,  nb triangles = 512 ,  nb boundary edges 64
  SkyLineMatrix: size pL/pU: 1891 90933 90933 moy=48.0873
  -- Solve :
          min -0.841471  max 0.000180202
          min -0.000179038  max 0.841471
          min -0.862765  max 0.970456
  -- Square mesh : nb vertices  =1089 ,  nb triangles = 2048 ,  nb boundary edges 128
  SkyLineMatrix: size pL/pU: 7363 669627 669627 moy=90.9449
  -- Solve :
          min -0.841471  max 4.88422e-05
          min -4.86977e-05  max 0.841471
          min -0.405318  max 0.512515
  -- Square mesh : nb vertices  =4225 ,  nb triangles = 8192 ,  nb boundary edges 256
  SkyLineMatrix: size pL/pU: 29059 5116184 5116184 moy=176.062
  -- Solve :
          min -0.841471  max 1.27157e-05
          min -1.26973e-05  max 0.841471
          min -0.405669  max 0.283288
error for u with H0-norm = 0.146289
error for u with H0-norm = 0.0394371
error for u with H0-norm = 0.00959419
error for u with H0-norm = 0.00226112
error for u with H0-norm = 0.000543948
error for u with H0-norm = 0.000133084
-------------------------------------------------
error for u with H1-norm = 1.31358
error for u with H1-norm = 0.540412
error for u with H1-norm = 0.22945
error for u with H1-norm = 0.105687
error for u with H1-norm = 0.0511718
error for u with H1-norm = 0.0252538
-------------------------------------------------
error for p with H0-norm = 4.24592
error for p with H0-norm = 1.60201
error for p with H0-norm = 0.482251
error for p with H0-norm = 0.131902
error for p with H0-norm = 0.0373726
error for p with H0-norm = 0.0111321
-------------------------------------------------
error order for u with H0-norm = 2.03932
error order for u with H1-norm = 1.23588
error order for p with H0-norm = 1.73203
-------------------------------------------------
error order for u with H0-norm = 2.08513
error order for u with H1-norm = 1.11839
error order for p with H0-norm = 1.87032
-------------------------------------------------
error order for u with H0-norm = 2.0555
error order for u with H1-norm = 1.04637
error order for p with H0-norm = 1.81941
-------------------------------------------------
error order for u with H0-norm = 2.03113
error order for u with H1-norm = 1.01885
error order for p with H0-norm = 1.74725
-------------------------------------------------
error order for u with H0-norm = 2.01699
error order for u with H1-norm = 1.00824
error order for p with H0-norm = 1.67015
-------------------------------------------------
times: compile 1.411s, execution 6.561s,  mpirank:0
 try getConsole C:\Users\sakis\Desktop\FreeFemCodes\Correct Codes\Παράδειγμα 4\Mini\Mini P1b.P1 (corner flow).edp
